<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.myPro.attendance.mapper.ClockInRecordMapper">

    <select id="selectFirstRecord" resultType="com.myPro.model.app.ClockInRecord">
        SELECT *
        FROM `clock_in_record`
        WHERE user_id = #{ userId } AND is_deleted = 0
        ORDER BY clock_in_time DESC
        LIMIT 1;
    </select>
    <select id="selectCountThisMonth" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM `clock_in_record`
        WHERE `clock_in_time` BETWEEN DATE_FORMAT(NOW() ,'%Y-%m-01') AND LAST_DAY(NOW())
        AND user_id = #{ userId }
        AND is_deleted = 0;
    </select>
    <select id="getRecordsByDays" resultType="com.myPro.Do.ClockInRecordDo">
        SELECT DATE(clock_in_time) AS clockInRecordDate,COUNT(*) AS recordNum FROM `clock_in_record`
        WHERE clock_in_time >= DATE_SUB(CURDATE(),INTERVAL 7 DAY)
        AND `is_deleted` = 0
        GROUP BY DATE(clock_in_time)
        ORDER BY clockInRecordDate DESC
    </select>

</mapper>